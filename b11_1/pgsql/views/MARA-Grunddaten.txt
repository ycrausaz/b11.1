DROP VIEW IF EXISTS MARA_Grunddaten;
CREATE VIEW MARA_Grunddaten AS
SELECT
    a.positions_nr AS SOURCE_ID,
    b.text AS MTART,
    c.text AS MEINS,
    a.herstellerteilenummer AS MFRPN,
    a.hersteller_nr_gp AS MFRNR,
    a.groesse_abmessung AS GROES,
    a.nettogewicht AS NTGEW,
    a.laenge AS LAENG,
    a.breite AS BREIT,
    a.hoehe AS HOEHE,
    a.einheit_l_b_h AS MEABM,
    a.gewichtseinheit AS GEWEI,
    d.text AS PROFL,
    a.nato_versorgungs_nr AS NSNID,
    a.ean_upc_code AS EAN11,
    CASE WHEN a.ean_upc_code IS NOT NULL THEN 'HE' ELSE NULL END AS NUMTP,
    e.text AS BEGRU,
    a.normbezeichnung AS NORMT,
    'M' AS MBRSH,
    a.warengruppe as MATKL,
    '' as BISMT,
    a.bruttogewicht AS BRGEW,
    a.bestellmengeneinheit AS BSTME,
    f.text AS SPART,
    a.chargenpflicht AS XCHPF,
    'V1' AS MSTAE,
    '' AS MTPOS_MARA,
    CASE WHEN a.chargenpflicht = 'f' THEN '1' ELSE '2' END AS MCOND,
    a.fuehrendes_material AS ZZFUEHR_MAT,
    g.text AS ZZLABEL,
    h.text AS RETDELC,
    i.text AS ADSPC_SPC,
    a.produkthierarchie AS PRDHA,
    'UAM' AS HNDLCODE,
    j.text as TEMPB,
    a.cpv_code AS ZZCPVCODE,
    k.text as ZZSONDERABLAUF,
    a.lagerfaehigkeit as "MARA-MHDHB"
FROM b11_1_material a
join b11_1_materialart b on b.id = a.materialart_grunddaten_id
join b11_1_basismengeneinheit c on c.id = a.basismengeneinheit_id
join b11_1_gefahrgutkennzeichen d on d.id = a.gefahrgutkennzeichen_id
join b11_1_begru e on e.id = a.begru_id
join b11_1_sparte f on f.id = a.sparte_id
join b11_1_auszeichnungsfeld g on g.id = a.auszeichnungsfeld_id
join b11_1_rueckfuehrungscode h on h.id = a.rueckfuehrungscode_id
join b11_1_sparepartclasscode i on i.id = a.spare_part_class_code_id
join b11_1_temperaturbedingung j on j.id = a.temperaturbedingung_id
join b11_1_sonderablauf k on k.id = a.sonderablauf_id
where a.is_transferred='t';
